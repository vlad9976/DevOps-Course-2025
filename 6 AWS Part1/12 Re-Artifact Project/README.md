
# 🔁 VProfile Re-Artifact AWS Deployment (Modernized Architecture)

This project demonstrates **Re-Artifact deployment** of the VProfile app using AWS PaaS services like Elastic Beanstalk, RDS, Elastic Cache, ActiveMQ, and CloudFront. It moves from classic lift-and-shift toward modern, managed, and elastic infrastructure.

---

## 🎯 Objective

- Flexible, serverless-friendly architecture
- No upfront cost using on-demand resources
- PaaS & SaaS service model adoption
- Infrastructure as Code (IaC) mindset

---

## 🧱 AWS Services Overview

### 🚀 Frontend (Elastic Beanstalk Platform)
- EC2 with Tomcat on Beanstalk
- Nginx Load Balancer (Beanstalk managed)
- Auto Scaling (Beanstalk managed)
- s3 / EFS for artifact and media storage

### 🛠 Backend Services
- Amazon RDS (MySQL)
- Amazon ElasticCache (Memcached)
- Amazon MQ (RabbitMQ)
- Route 53 (Private DNS)
- CloudFront (CDN for HTTPS delivery)

---

## 🔁 Workflow Execution

1. **Login to AWS**
2. **Create Key Pair** for Beanstalk EC2 access
3. **Create Security Group**: `vprofile-rearch-backend-SG`
4. **Provision:**
   - RDS Instance
   - ElasticCache Cluster (Memcached)
   - ActiveMQ Broker
5. **Create Elastic Beanstalk Environment**
6. **Initialize RDS DB via EC2 mysql-client**
7. **Build WAR Artifact** from code
8. **Upload and Deploy WAR** to Beanstalk
9. **Enable HTTPS via ACM & Elastic Beanstalk Listener**
10. **Update DNS record in GoDaddy for CNAME**
11. **Create CloudFront Distribution as CDN**
12. **Test HTTPS and CDN delivery**

---

## ⚙️ Backend Configuration

| Component     | AWS Service       | Notes |
|---------------|-------------------|-------|
| MySQL         | Amazon RDS        | Created with parameter/subnet group |
| Memcached     | ElasticCache      | Cluster-based, backend SG allowed |
| RabbitMQ      | Amazon MQ         | Private access with custom login |
| DNS           | Route 53 / GoDaddy| Private + Public DNS entries |
| CDN           | CloudFront        | Added SSL cert, GoDaddy CNAME |

---

## 🧪 Initialization Steps

### 🧩 RDS
- DB Name: `accounts`
- DB Engine: MySQL 8.4
- Subnet group: All AZs
- Security group: `vprofile-rearch-backend-SG`
- User: `admin`, Password: autogenerated

### 🧩 Elastic Cache
- Engine: Memcached 1.6
- Port: 11211
- Subnet group: All AZs
- SG: `vprofile-rearch-backend-SG`

### 🧩 ActiveMQ
- Engine: RabbitMQ 3.13
- Broker Type: Single instance
- Username: `rabbit`
- Password: **REDACTED**
- Private deployment mode
- SG: `vprofile-rearch-backend-SG`

### 🧩 EC2 mysql-client
- Launch EC2 Ubuntu instance
- Use to connect and initialize RDS from SQL dump

```bash
apt update && apt install mysql-client git -y
git clone https://github.com/hkhcoder/vprofile-project.git
cd vprofile-project/
git checkout awsrefactor
mysql -h <rds-endpoint> -u admin -p < db_backup.sql
```

---

## 🏗 Beanstalk Configuration

- App Name: `vprofile-rearch-beanapp`
- Env Name: `vprofile-rearch-beanapp-prod`
- Platform: Tomcat 10 (Java 21)
- Environment: Load Balanced
- Min/Max Instances: 2–4
- Load Balancer: Application Load Balancer (ALB)
- Auto Scaling: Trigger on NetworkOut or CPU
- Session Stickiness: Enabled
- EC2 Profile: `vprofile-rearch-beanstalk` IAM role

---

## 📦 Artifact Build & Upload

```bash
git clone -b awsrefactor https://github.com/hkhcoder/vprofile-project.git
# Edit `src/main/resources/application.properties`:
# - MySQL RDS endpoint
# - RabbitMQ endpoint and credentials
# - Memcache DNS

mvn install

# Upload WAR file in `target/vprofile-v2.war` to Elastic Beanstalk
# Go to EB Environment > Upload & Deploy
```

---

## 🔒 HTTPS Certificate

- Add ACM certificate in `us-east-1`
- In EB environment > config > add HTTPS (port 443) listener
- Attach SSL certificate from dropdown (GoDaddy)

---

## 🌐 DNS + CDN

### Route 53 + GoDaddy
- Create CNAME record:
  `vprorearch.dgday.online` → `*.elasticbeanstalk.com` (or CloudFront URL)

### CloudFront
- Origin: EB Load Balancer DNS
- Policy: Match viewer, All headers/query/cookies
- Custom domain: `vprorearch.dgday.online`
- Certificate: ACM cert for GoDaddy domain

---

## 🧪 Testing

- 🔗 HTTP: `http://provarch.us-east-1.elasticbeanstalk.com`
- 🔒 HTTPS: `https://vprorearch.dgday.online`
- 🌍 CDN: Check `favicon.ico` header for CloudFront

---

## ✅ Summary

| Layer         | Service            | Purpose                   |
|---------------|--------------------|---------------------------|
| Compute       | Elastic Beanstalk  | App server + NGINX + ASG  |
| Database      | Amazon RDS         | MySQL data                |
| Caching       | ElasticCache       | Memcached cache           |
| Messaging     | Amazon MQ          | RabbitMQ queues           |
| Storage       | S3 / EFS           | Shared storage            |
| DNS           | Route 53 + GoDaddy| Domain routing            |
| CDN           | CloudFront         | Performance + SSL         |

---

## 📚 Resources

- [Elastic Beanstalk Docs](https://docs.aws.amazon.com/elasticbeanstalk/)
- [RDS Docs](https://docs.aws.amazon.com/rds/)
- [Amazon MQ Docs](https://docs.aws.amazon.com/amazon-mq/)
- [CloudFront Docs](https://docs.aws.amazon.com/cloudfront/)
